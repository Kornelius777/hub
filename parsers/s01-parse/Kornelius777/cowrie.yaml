onsuccess: next_stage
name: Kornelius777/cowrie-command-attempt
description: "Parse Cowrie Honeypot logs"
filter: "evt.Parsed.program == 'cowrie'"

nodes:
  - grok:
      pattern: "%{TIMESTAMP_ISO8601:time}.*SSHChannel session \\(%{NUMBER}\\) on SSHService.* on HoneyPotSSHTransport,%{NUMBER},%{IPV4:validIP}\\] Command found:"
      apply_on: message
statics:
  - meta: log_type
    value: cowrie_command_attempt
  - meta: source_ip
    expression: "evt.Parsed.validIP"
  - target: evt.StrTime
    expression: evt.Parsed.time
  - meta: service
    value: cowrie
